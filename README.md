# SerialEM Scripts for Scipion Integration

This repository contains a set of SerialEM scripts and a Python script that facilitate the integration of Scipion with SerialEM for improved data acquisition. These scripts allow for automatic adjustment of acquisition parameters based on the evaluation results from Scipion.

## Scripts

1. **CheckScipion.txt**
  - Reads data from Scipion and sets flags for checking astigmatism and drift correction.
  - If astigmatism correction is required, it calls the `AlignComaAndStig` script to perform the correction.
  - If drift correction is required, it launches the `DriftWaitTask` to correct for drift.
  - Evaluates the focus offset values from Scipion and adjusts the minimal and maximal defocus targets accordingly.

2. **scipion_reading.py**
  - Python script that reads the `serialEM.csv` file generated by Scipion.
  - Checks for global shift (drift correction), defocus offset, and astigmatism flags.
  - If drift correction is required, it launches the `DriftWaitTask`.
  - If defocus offset is present, it sets the `FOCUS_OFFSET_min` or `FOCUS_OFFSET_max` variables accordingly.
  - If astigmatism correction is required, it sets the `CheckAstigmatism` flag.

3. **FocusScript.txt**
  - Defines the target defocus range and step size.
  - Reads the path to the Scipion output directory from a text file.
  - Adjusts the minimal and maximal defocus targets based on the `FOCUS_OFFSET_min` and `FOCUS_OFFSET_max` values set by the `scipion_reading` script.
  - Calls the `CheckScipion` script to read data from Scipion and set necessary flags.

## Usage

1. Place the scripts in the appropriate location within your SerialEM installation.
2. Set the path to the Scipion output directory in the `session_path.txt` file.
3. Run the `FocusScript.txt` to initiate the integration process.

The scripts will automatically read the Scipion evaluation results, adjust the acquisition parameters accordingly, and perform any necessary corrections or adjustments during the data acquisition process.

## Notes

- Ensure that the `serialEM.csv` file generated by Scipion is present in the specified output directory.
- The scripts assume a specific format for the `serialEM.csv` file. If the format changes, the `scipion_reading.txt` may need to be updated accordingly.
- The scripts are designed to work with the specific versions of SerialEM and Scipion used during their development. Compatibility with other versions is not guaranteed.

## Contributing

Contributions to this repository are welcome. If you encounter any issues or have suggestions for improvements, please open an issue or submit a pull request.
